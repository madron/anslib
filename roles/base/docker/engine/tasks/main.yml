- name: os specific variables
  include_vars: "{{ ansible_lsb.id|lower() }}_{{ ansible_lsb.codename }}.yml"
  tags:
    - docker
    - docker-engine


- include: debian.yml
  when: ansible_os_family == 'Debian'
  tags:
    - docker
    - docker-engine


- name: fix ubuntu trusty pip installation
  command: easy_install -U pip
  args:
    creates: /usr/local/bin/pip
  when: ansible_lsb.id == 'Ubuntu' and ansible_lsb.codename == 'trusty'
  tags:
    - docker
    - docker-engine


- name: docker-py latest
  pip:
    name: docker-py
    state: latest
  when: docker_engine_py_version == 'latest'
  tags:
    - docker
    - docker-engine
    - docker-engine-py


- name: docker-py version
  pip:
    name: docker-py
    state: present
    version: '{{ docker_engine_py_version }}'
  when: docker_engine_py_version and not docker_engine_py_version == 'latest'
  tags:
    - docker
    - docker-engine
    - docker-engine-py


- name: accounts
  docker_login:
    registry: '{{ item.key }}'
    username: '{{ item.value.username }}'
    password: '{{ item.value.password }}'
  when: '{{ not docker_engine_api_version }}'
  with_dict: '{{ docker_engine_accounts }}'
  tags:
    - docker
    - docker-engine
    - docker-engine-accounts
