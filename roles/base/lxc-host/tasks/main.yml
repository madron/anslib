- name: Role nginx - ppa repository
  apt_repository: >
    repo=ppa:ubuntu-lxc/stable
    state=present

- name: required packages
  apt: >
    name={{ item }}
    state=latest
  with_items:
    - cgroup-bin
    - lxc
    - lxc-templates
    - python3-lxc

- name: lxc.conf
  template: >
    src=default.conf
    dest=/etc/lxc/default.conf
    mode=0644
    owner=root
    group=root

# Generate a random mac address (ensure that first number is even)
# openssl rand -hex 6 | sed 's/\(..\)/\1:/g; s/.$//'

# Clone a vm
# lxc-clone -o play_fresh -n play1
#
# Destroy and recreate a vm from scratch
# lxc-kill -n play1; lxc-destroy -n play1; lxc-create -t ubuntu -n play1
#
# Regen ansible config and then start the vm
# lxc-start -d -n play1


- { include: instance_remove.yml }

- { include: instance.yml }
