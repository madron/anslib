- name: initial admin user
  command: >
    htpasswd -bc {{ webdav_htpasswd_file }} {{ webdav_htpasswd_username }} {{ webdav_htpasswd_password }}
    creates={{ webdav_htpasswd_file }}
  when: webdav_htpasswd_username is defined
  tags:
    - webdav


- name: htpasswd file
  command: >
    touch {{ webdav_htpasswd_file }}
    creates={{ webdav_htpasswd_file }}
  tags:
    - webdav

- name: htpasswd file permission
  file: >
    path={{ webdav_htpasswd_file }}
    state=file
    mode=0640
    owner=root
    group=www-data
  tags:
    - webdav
