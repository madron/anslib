- name: htpasswd users
  htpasswd: >
    path={{ webdav_htpasswd_file }}
    name={{ item.username }}
    password={{ item.password }}
    mode=0640
    owner=root
    group=www-data
  with_items: webdav_htpasswd_users
  tags:
    - webdav

- name: htpasswd file
  command: >
    touch {{ webdav_htpasswd_file }}
    creates={{ webdav_htpasswd_file }}
  tags:
    - webdav

- name: htpasswd file permission
  file: >
    path={{ webdav_htpasswd_file }}
    state=file
    mode=0640
    owner=root
    group=www-data
  tags:
    - webdav
