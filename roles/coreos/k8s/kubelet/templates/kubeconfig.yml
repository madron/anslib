apiVersion: v1
kind: Config
preferences: {}

clusters:
  - cluster:
      certificate-authority: /etc/kubernetes/ssl/ca.pem
{% for host in k8s_master_hosts %}
      server: https://{{ hostvars[host].ansible_host }}
{% endfor %}
    name: production

contexts:
  - context:
      cluster: production
      user: kubelet
    name: kubelet-context
current-context: kubelet-context

users:
  - name: kubelet
    user:
      client-certificate: /etc/kubernetes/ssl/{{ inventory_hostname }}-worker.pem
      client-key: /etc/kubernetes/ssl/{{ inventory_hostname }}-worker-key.pem
