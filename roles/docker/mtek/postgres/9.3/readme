docker build -t mtek/postgres:9.3 roles/docker/mtek/postgres/9.3/files/docker/

# remove db volume
docker rm -v db_master_volume
docker rm -v db_slave_volume

# db volume
docker run --name db_master_volume -v /data busybox
docker run --name db_slave_volume  -v /data busybox

# Run server
docker run -i -t --rm --name db_master --volumes-from db_master_volume -e WAL_KEEP_SEGMENTS=20 mtek/postgres:9.3
docker run -i -t --rm --name db_slave  --volumes-from db_slave_volume  --link db_master:master -e WAL_KEEP_SEGMENTS=20 -e MASTER_SERVER=master mtek/postgres:9.3
docker run -i -t --rm --name db_master  --volumes-from db_master_volume  --link db_slave:master -e WAL_KEEP_SEGMENTS=20 -e MASTER_SERVER=master mtek/postgres:9.3

# Backup to /tmp
docker run -i -t --rm --volumes-from db_master -v /tmp:/backup mtek/postgres:9.3 backup --overwrite
docker run -i -t --rm --volumes-from db_slave  -v /tmp:/backup mtek/postgres:9.3 backup --overwrite

# restore backup from /tmp
docker run -i -t --rm --volumes-from db_master -v /tmp:/backup:ro mtek/postgres:9.3 restore
docker run -i -t --rm --volumes-from db_slave  -v /tmp:/backup:ro mtek/postgres:9.3 restore

# Create syncuser
docker run -i -t --rm --link db_master:postgres mtek/postgres:9.3 syncuser syncuser
