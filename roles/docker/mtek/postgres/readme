docker build -t mtek/postgres:9.1 roles/docker/mtek/postgres/9.1/files/docker/


# remove db volume
docker rm db_master_volume
docker rm db_slave_volume

# db volume
docker run --name db_master_volume -v /data busybox
docker run --name db_slave_volume  -v /data busybox

# Run server
docker run -i -t --rm --name db_master --volumes-from db_master_volume -e WAL_KEEP_SEGMENTS=20 mtek/postgres:9.1
docker run -i -t --rm --name db_slave  --volumes-from db_slave_volume  --link db_master:master -e WAL_KEEP_SEGMENTS=20 -e MASTER_SERVER=master mtek/postgres:9.1
docker run -i -t --rm --name db_master  --volumes-from db_master_volume  --link db_slave:master -e WAL_KEEP_SEGMENTS=20 -e MASTER_SERVER=master mtek/postgres:9.1

# Backup to /tmp
docker run -i -t --rm --link db_master:postgres -v /tmp:/backup mtek/postgres:9.1 backup
docker run -i -t --rm --link db_slave:postgres  -v /tmp:/backup mtek/postgres:9.1 backup

# restore backup from /tmp
docker run -i -t --rm --volumes-from db_master_volume -v /tmp:/backup busybox cp -a /backup/data /
docker run -i -t --rm --volumes-from db_slave_volume  -v /tmp:/backup busybox cp -a /backup/data /

# Create syncuser
docker run -i -t --rm --link db_master:postgres mtek/postgres:9.1 syncuser syncuser
